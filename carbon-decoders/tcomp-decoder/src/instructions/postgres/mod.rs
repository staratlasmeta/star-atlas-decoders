//! This code was AUTOGENERATED using the Codama library.
pub mod bid_row;
pub mod buy_core_row;
pub mod buy_row;
pub mod buy_spl_row;
pub mod cancel_bid_row;
pub mod close_expired_bid_row;
pub mod close_expired_listing_core_row;
pub mod close_expired_listing_row;
pub mod delist_core_row;
pub mod delist_row;
pub mod edit_row;
pub mod list_core_row;
pub mod list_row;
pub mod take_bid_core_row;
pub mod take_bid_full_meta_row;
pub mod take_bid_legacy_row;
pub mod take_bid_meta_hash_row;
pub mod take_bid_t22_row;
pub mod take_bid_wns_row;
pub mod tcomp_noop_row;
pub mod withdraw_fees_row;

pub use self::bid_row::*;
pub use self::buy_core_row::*;
pub use self::buy_row::*;
pub use self::buy_spl_row::*;
pub use self::cancel_bid_row::*;
pub use self::close_expired_bid_row::*;
pub use self::close_expired_listing_core_row::*;
pub use self::close_expired_listing_row::*;
pub use self::delist_core_row::*;
pub use self::delist_row::*;
pub use self::edit_row::*;
pub use self::list_core_row::*;
pub use self::list_row::*;
pub use self::take_bid_core_row::*;
pub use self::take_bid_full_meta_row::*;
pub use self::take_bid_legacy_row::*;
pub use self::take_bid_meta_hash_row::*;
pub use self::take_bid_t22_row::*;
pub use self::take_bid_wns_row::*;
pub use self::tcomp_noop_row::*;
pub use self::withdraw_fees_row::*;

use super::TcompInstruction;

pub struct TcompInstructionsMigration;

impl sqlx_migrator::Migration<sqlx::Postgres> for TcompInstructionsMigration {
    fn app(&self) -> &str {
        "tcomp"
    }

    fn name(&self) -> &str {
        "tcomp_instructions"
    }

    fn operations(&self) -> Vec<Box<dyn sqlx_migrator::Operation<sqlx::Postgres>>> {
        vec![
            Box::new(BidMigrationOperation),
            Box::new(BuyMigrationOperation),
            Box::new(BuyCoreMigrationOperation),
            Box::new(BuySplMigrationOperation),
            Box::new(CancelBidMigrationOperation),
            Box::new(CloseExpiredBidMigrationOperation),
            Box::new(CloseExpiredListingMigrationOperation),
            Box::new(CloseExpiredListingCoreMigrationOperation),
            Box::new(DelistMigrationOperation),
            Box::new(DelistCoreMigrationOperation),
            Box::new(EditMigrationOperation),
            Box::new(ListMigrationOperation),
            Box::new(ListCoreMigrationOperation),
            Box::new(TakeBidCoreMigrationOperation),
            Box::new(TakeBidFullMetaMigrationOperation),
            Box::new(TakeBidLegacyMigrationOperation),
            Box::new(TakeBidMetaHashMigrationOperation),
            Box::new(TakeBidT22MigrationOperation),
            Box::new(TakeBidWnsMigrationOperation),
            Box::new(TcompNoopMigrationOperation),
            Box::new(WithdrawFeesMigrationOperation),
        ]
    }

    fn parents(&self) -> Vec<Box<dyn sqlx_migrator::Migration<sqlx::Postgres>>> {
        vec![]
    }
}

pub struct TcompInstructionWithMetadata(
    pub TcompInstruction,
    pub carbon_core::instruction::InstructionMetadata,
);

impl
    From<(
        TcompInstruction,
        carbon_core::instruction::InstructionMetadata,
    )> for TcompInstructionWithMetadata
{
    fn from(
        value: (
            TcompInstruction,
            carbon_core::instruction::InstructionMetadata,
        ),
    ) -> Self {
        TcompInstructionWithMetadata(value.0, value.1)
    }
}

#[async_trait::async_trait]
impl carbon_core::postgres::operations::Insert for TcompInstructionWithMetadata {
    async fn insert(&self, pool: &sqlx::PgPool) -> carbon_core::error::CarbonResult<()> {
        let TcompInstructionWithMetadata(instruction, metadata) = self;
        match instruction {
            TcompInstruction::TcompNoop(instruction) => {
                let row =
                    tcomp_noop_row::TcompNoopRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            TcompInstruction::WithdrawFees(instruction) => {
                let row = withdraw_fees_row::WithdrawFeesRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            TcompInstruction::Buy(instruction) => {
                let row = buy_row::BuyRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            TcompInstruction::BuySpl(instruction) => {
                let row = buy_spl_row::BuySplRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            TcompInstruction::BuyCore(instruction) => {
                let row =
                    buy_core_row::BuyCoreRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            TcompInstruction::List(instruction) => {
                let row = list_row::ListRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            TcompInstruction::Delist(instruction) => {
                let row = delist_row::DelistRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            TcompInstruction::Edit(instruction) => {
                let row = edit_row::EditRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            TcompInstruction::ListCore(instruction) => {
                let row =
                    list_core_row::ListCoreRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            TcompInstruction::DelistCore(instruction) => {
                let row = delist_core_row::DelistCoreRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            TcompInstruction::Bid(instruction) => {
                let row = bid_row::BidRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            TcompInstruction::CancelBid(instruction) => {
                let row =
                    cancel_bid_row::CancelBidRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            TcompInstruction::CloseExpiredBid(instruction) => {
                let row = close_expired_bid_row::CloseExpiredBidRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            TcompInstruction::CloseExpiredListing(instruction) => {
                let row = close_expired_listing_row::CloseExpiredListingRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            TcompInstruction::CloseExpiredListingCore(instruction) => {
                let row = close_expired_listing_core_row::CloseExpiredListingCoreRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            TcompInstruction::TakeBidMetaHash(instruction) => {
                let row = take_bid_meta_hash_row::TakeBidMetaHashRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            TcompInstruction::TakeBidFullMeta(instruction) => {
                let row = take_bid_full_meta_row::TakeBidFullMetaRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            TcompInstruction::TakeBidLegacy(instruction) => {
                let row = take_bid_legacy_row::TakeBidLegacyRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            TcompInstruction::TakeBidT22(instruction) => {
                let row = take_bid_t22_row::TakeBidT22Row::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            TcompInstruction::TakeBidWns(instruction) => {
                let row = take_bid_wns_row::TakeBidWnsRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            TcompInstruction::TakeBidCore(instruction) => {
                let row = take_bid_core_row::TakeBidCoreRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
        }
    }
}

#[async_trait::async_trait]
impl carbon_core::postgres::operations::Upsert for TcompInstructionWithMetadata {
    async fn upsert(&self, pool: &sqlx::PgPool) -> carbon_core::error::CarbonResult<()> {
        let TcompInstructionWithMetadata(instruction, metadata) = self;
        match instruction {
            TcompInstruction::TcompNoop(instruction) => {
                let row =
                    tcomp_noop_row::TcompNoopRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            TcompInstruction::WithdrawFees(instruction) => {
                let row = withdraw_fees_row::WithdrawFeesRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            TcompInstruction::Buy(instruction) => {
                let row = buy_row::BuyRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            TcompInstruction::BuySpl(instruction) => {
                let row = buy_spl_row::BuySplRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            TcompInstruction::BuyCore(instruction) => {
                let row =
                    buy_core_row::BuyCoreRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            TcompInstruction::List(instruction) => {
                let row = list_row::ListRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            TcompInstruction::Delist(instruction) => {
                let row = delist_row::DelistRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            TcompInstruction::Edit(instruction) => {
                let row = edit_row::EditRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            TcompInstruction::ListCore(instruction) => {
                let row =
                    list_core_row::ListCoreRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            TcompInstruction::DelistCore(instruction) => {
                let row = delist_core_row::DelistCoreRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            TcompInstruction::Bid(instruction) => {
                let row = bid_row::BidRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            TcompInstruction::CancelBid(instruction) => {
                let row =
                    cancel_bid_row::CancelBidRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            TcompInstruction::CloseExpiredBid(instruction) => {
                let row = close_expired_bid_row::CloseExpiredBidRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            TcompInstruction::CloseExpiredListing(instruction) => {
                let row = close_expired_listing_row::CloseExpiredListingRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            TcompInstruction::CloseExpiredListingCore(instruction) => {
                let row = close_expired_listing_core_row::CloseExpiredListingCoreRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            TcompInstruction::TakeBidMetaHash(instruction) => {
                let row = take_bid_meta_hash_row::TakeBidMetaHashRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            TcompInstruction::TakeBidFullMeta(instruction) => {
                let row = take_bid_full_meta_row::TakeBidFullMetaRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            TcompInstruction::TakeBidLegacy(instruction) => {
                let row = take_bid_legacy_row::TakeBidLegacyRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            TcompInstruction::TakeBidT22(instruction) => {
                let row = take_bid_t22_row::TakeBidT22Row::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            TcompInstruction::TakeBidWns(instruction) => {
                let row = take_bid_wns_row::TakeBidWnsRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            TcompInstruction::TakeBidCore(instruction) => {
                let row = take_bid_core_row::TakeBidCoreRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
        }
    }
}

//! This code was AUTOGENERATED using the Codama library.
pub mod add_cargo_row;
pub mod close_cargo_pod_row;
pub mod close_token_account_row;
pub mod consume_cargo_row;
pub mod init_cargo_pod_row;
pub mod init_cargo_type_for_next_seq_id_row;
pub mod init_cargo_type_from_old_cargo_type_row;
pub mod init_cargo_type_row;
pub mod init_definition_row;
pub mod legitimize_cargo_row;
pub mod mint_to_row;
pub mod remove_cargo_row;
pub mod transfer_authority_row;
pub mod transfer_cargo_row;
pub mod update_cargo_pod_row;
pub mod update_definition_row;
pub mod update_pod_token_account_row;

pub use self::add_cargo_row::*;
pub use self::close_cargo_pod_row::*;
pub use self::close_token_account_row::*;
pub use self::consume_cargo_row::*;
pub use self::init_cargo_pod_row::*;
pub use self::init_cargo_type_for_next_seq_id_row::*;
pub use self::init_cargo_type_from_old_cargo_type_row::*;
pub use self::init_cargo_type_row::*;
pub use self::init_definition_row::*;
pub use self::legitimize_cargo_row::*;
pub use self::mint_to_row::*;
pub use self::remove_cargo_row::*;
pub use self::transfer_authority_row::*;
pub use self::transfer_cargo_row::*;
pub use self::update_cargo_pod_row::*;
pub use self::update_definition_row::*;
pub use self::update_pod_token_account_row::*;

use super::CargoInstruction;

pub struct CargoInstructionsMigration;

impl sqlx_migrator::Migration<sqlx::Postgres> for CargoInstructionsMigration {
    fn app(&self) -> &str {
        "cargo"
    }

    fn name(&self) -> &str {
        "cargo_instructions"
    }

    fn operations(&self) -> Vec<Box<dyn sqlx_migrator::Operation<sqlx::Postgres>>> {
        vec![
            Box::new(AddCargoMigrationOperation),
            Box::new(CloseCargoPodMigrationOperation),
            Box::new(CloseTokenAccountMigrationOperation),
            Box::new(ConsumeCargoMigrationOperation),
            Box::new(InitCargoPodMigrationOperation),
            Box::new(InitCargoTypeMigrationOperation),
            Box::new(InitCargoTypeForNextSeqIdMigrationOperation),
            Box::new(InitCargoTypeFromOldCargoTypeMigrationOperation),
            Box::new(InitDefinitionMigrationOperation),
            Box::new(LegitimizeCargoMigrationOperation),
            Box::new(MintToMigrationOperation),
            Box::new(RemoveCargoMigrationOperation),
            Box::new(TransferAuthorityMigrationOperation),
            Box::new(TransferCargoMigrationOperation),
            Box::new(UpdateCargoPodMigrationOperation),
            Box::new(UpdateDefinitionMigrationOperation),
            Box::new(UpdatePodTokenAccountMigrationOperation),
        ]
    }

    fn parents(&self) -> Vec<Box<dyn sqlx_migrator::Migration<sqlx::Postgres>>> {
        vec![]
    }
}

pub struct CargoInstructionWithMetadata(
    pub CargoInstruction,
    pub carbon_core::instruction::InstructionMetadata,
);

impl
    From<(
        CargoInstruction,
        carbon_core::instruction::InstructionMetadata,
    )> for CargoInstructionWithMetadata
{
    fn from(
        value: (
            CargoInstruction,
            carbon_core::instruction::InstructionMetadata,
        ),
    ) -> Self {
        CargoInstructionWithMetadata(value.0, value.1)
    }
}

#[async_trait::async_trait]
impl carbon_core::postgres::operations::Insert for CargoInstructionWithMetadata {
    async fn insert(&self, pool: &sqlx::PgPool) -> carbon_core::error::CarbonResult<()> {
        let CargoInstructionWithMetadata(instruction, metadata) = self;
        match instruction {
            CargoInstruction::AddCargo(instruction) => {
                let row =
                    add_cargo_row::AddCargoRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            CargoInstruction::CloseCargoPod(instruction) => {
                let row = close_cargo_pod_row::CloseCargoPodRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CargoInstruction::CloseTokenAccount(instruction) => {
                let row = close_token_account_row::CloseTokenAccountRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CargoInstruction::ConsumeCargo(instruction) => {
                let row = consume_cargo_row::ConsumeCargoRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CargoInstruction::InitCargoPod(instruction) => {
                let row = init_cargo_pod_row::InitCargoPodRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CargoInstruction::InitCargoType(instruction) => {
                let row = init_cargo_type_row::InitCargoTypeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CargoInstruction::InitCargoTypeForNextSeqId(instruction) => {
                let row =
                    init_cargo_type_for_next_seq_id_row::InitCargoTypeForNextSeqIdRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                    );
                row.insert(pool).await?;
                Ok(())
            }
            CargoInstruction::InitCargoTypeFromOldCargoType(instruction) => {
                let row = init_cargo_type_from_old_cargo_type_row::InitCargoTypeFromOldCargoTypeRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            CargoInstruction::InitDefinition(instruction) => {
                let row = init_definition_row::InitDefinitionRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CargoInstruction::LegitimizeCargo(instruction) => {
                let row = legitimize_cargo_row::LegitimizeCargoRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CargoInstruction::MintTo(instruction) => {
                let row = mint_to_row::MintToRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            CargoInstruction::RemoveCargo(instruction) => {
                let row = remove_cargo_row::RemoveCargoRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CargoInstruction::TransferAuthority(instruction) => {
                let row = transfer_authority_row::TransferAuthorityRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CargoInstruction::TransferCargo(instruction) => {
                let row = transfer_cargo_row::TransferCargoRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CargoInstruction::UpdateCargoPod(instruction) => {
                let row = update_cargo_pod_row::UpdateCargoPodRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CargoInstruction::UpdateDefinition(instruction) => {
                let row = update_definition_row::UpdateDefinitionRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CargoInstruction::UpdatePodTokenAccount(instruction) => {
                let row = update_pod_token_account_row::UpdatePodTokenAccountRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
        }
    }
}

#[async_trait::async_trait]
impl carbon_core::postgres::operations::Upsert for CargoInstructionWithMetadata {
    async fn upsert(&self, pool: &sqlx::PgPool) -> carbon_core::error::CarbonResult<()> {
        let CargoInstructionWithMetadata(instruction, metadata) = self;
        match instruction {
            CargoInstruction::AddCargo(instruction) => {
                let row =
                    add_cargo_row::AddCargoRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            CargoInstruction::CloseCargoPod(instruction) => {
                let row = close_cargo_pod_row::CloseCargoPodRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CargoInstruction::CloseTokenAccount(instruction) => {
                let row = close_token_account_row::CloseTokenAccountRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CargoInstruction::ConsumeCargo(instruction) => {
                let row = consume_cargo_row::ConsumeCargoRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CargoInstruction::InitCargoPod(instruction) => {
                let row = init_cargo_pod_row::InitCargoPodRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CargoInstruction::InitCargoType(instruction) => {
                let row = init_cargo_type_row::InitCargoTypeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CargoInstruction::InitCargoTypeForNextSeqId(instruction) => {
                let row =
                    init_cargo_type_for_next_seq_id_row::InitCargoTypeForNextSeqIdRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                    );
                row.upsert(pool).await?;
                Ok(())
            }
            CargoInstruction::InitCargoTypeFromOldCargoType(instruction) => {
                let row = init_cargo_type_from_old_cargo_type_row::InitCargoTypeFromOldCargoTypeRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            CargoInstruction::InitDefinition(instruction) => {
                let row = init_definition_row::InitDefinitionRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CargoInstruction::LegitimizeCargo(instruction) => {
                let row = legitimize_cargo_row::LegitimizeCargoRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CargoInstruction::MintTo(instruction) => {
                let row = mint_to_row::MintToRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            CargoInstruction::RemoveCargo(instruction) => {
                let row = remove_cargo_row::RemoveCargoRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CargoInstruction::TransferAuthority(instruction) => {
                let row = transfer_authority_row::TransferAuthorityRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CargoInstruction::TransferCargo(instruction) => {
                let row = transfer_cargo_row::TransferCargoRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CargoInstruction::UpdateCargoPod(instruction) => {
                let row = update_cargo_pod_row::UpdateCargoPodRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CargoInstruction::UpdateDefinition(instruction) => {
                let row = update_definition_row::UpdateDefinitionRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CargoInstruction::UpdatePodTokenAccount(instruction) => {
                let row = update_pod_token_account_row::UpdatePodTokenAccountRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
        }
    }
}

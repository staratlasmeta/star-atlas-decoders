//! This code was AUTOGENERATED using the Codama library.
use crate::types::graphql::OptionalNonSystemPubkeyGraphQL;
use carbon_core::graphql::primitives::I64;
use carbon_core::graphql::primitives::Pubkey;
use carbon_core::graphql::primitives::U8;
use carbon_core::graphql::primitives::U64;
use juniper::GraphQLObject;

#[derive(Debug, Clone, GraphQLObject)]
#[graphql(name = "Recipe")]
pub struct RecipeGraphQL {
    pub account_metadata: crate::accounts::graphql::AccountMetadataGraphQL,
    pub version: U8,
    pub domain: Pubkey,
    pub category: Pubkey,
    pub creator: Pubkey,
    pub duration: I64,
    pub min_duration: I64,
    pub namespace: Vec<U8>,
    pub status: U8,
    pub fee_amount: U64,
    pub fee_recipient: OptionalNonSystemPubkeyGraphQL,
    pub usage_count: U64,
    pub usage_limit: U64,
    pub value: U64,
    pub consumables_count: U8,
    pub non_consumables_count: U8,
    pub outputs_count: U8,
    pub total_count: i32,
}

impl TryFrom<crate::accounts::postgres::RecipeRow> for RecipeGraphQL {
    type Error = carbon_core::error::Error;
    fn try_from(row: crate::accounts::postgres::RecipeRow) -> Result<Self, Self::Error> {
        Ok(Self {
            account_metadata: row.account_metadata.into(),
            version: carbon_core::graphql::primitives::U8((*row.version) as u8),
            domain: carbon_core::graphql::primitives::Pubkey(row.domain.0),
            category: carbon_core::graphql::primitives::Pubkey(row.category.0),
            creator: carbon_core::graphql::primitives::Pubkey(row.creator.0),
            duration: carbon_core::graphql::primitives::I64(row.duration),
            min_duration: carbon_core::graphql::primitives::I64(row.min_duration),
            namespace: row
                .namespace
                .into_iter()
                .map(|item| carbon_core::graphql::primitives::U8(item))
                .collect(),
            status: carbon_core::graphql::primitives::U8((*row.status) as u8),
            fee_amount: carbon_core::graphql::primitives::U64(*row.fee_amount),
            fee_recipient: row.fee_recipient.0.into(),
            usage_count: carbon_core::graphql::primitives::U64(*row.usage_count),
            usage_limit: carbon_core::graphql::primitives::U64(*row.usage_limit),
            value: carbon_core::graphql::primitives::U64(*row.value),
            consumables_count: carbon_core::graphql::primitives::U8((*row.consumables_count) as u8),
            non_consumables_count: carbon_core::graphql::primitives::U8(
                (*row.non_consumables_count) as u8,
            ),
            outputs_count: carbon_core::graphql::primitives::U8((*row.outputs_count) as u8),
            total_count: (*row.total_count) as i32,
        })
    }
}

//! This code was AUTOGENERATED using the Codama library.
pub mod add_consumable_input_to_recipe_row;
pub mod add_crafting_facility_recipe_category_row;
pub mod add_non_consumable_input_to_recipe_row;
pub mod add_output_to_recipe_row;
pub mod add_recipe_ingredient_row;
pub mod burn_consumable_ingredient_row;
pub mod cancel_crafting_process_row;
pub mod claim_non_consumable_ingredient_row;
pub mod claim_recipe_output_row;
pub mod close_crafting_process_row;
pub mod create_crafting_process_row;
pub mod deregister_crafting_facility_row;
pub mod deregister_recipe_category_row;
pub mod drain_craftable_item_bank_row;
pub mod initialize_domain_row;
pub mod legitimize_recipe_ingredient_row;
pub mod register_craftable_item_row;
pub mod register_crafting_facility_row;
pub mod register_recipe_category_row;
pub mod register_recipe_row;
pub mod remove_consumable_input_from_recipe_row;
pub mod remove_crafting_facility_recipe_category_row;
pub mod remove_non_consumable_input_from_recipe_row;
pub mod remove_output_from_recipe_row;
pub mod remove_recipe_ingredient_row;
pub mod start_crafting_process_row;
pub mod stop_crafting_process_row;
pub mod update_crafting_facility_row;
pub mod update_domain_row;
pub mod update_recipe_category_row;
pub mod update_recipe_row;

pub use self::add_consumable_input_to_recipe_row::*;
pub use self::add_crafting_facility_recipe_category_row::*;
pub use self::add_non_consumable_input_to_recipe_row::*;
pub use self::add_output_to_recipe_row::*;
pub use self::add_recipe_ingredient_row::*;
pub use self::burn_consumable_ingredient_row::*;
pub use self::cancel_crafting_process_row::*;
pub use self::claim_non_consumable_ingredient_row::*;
pub use self::claim_recipe_output_row::*;
pub use self::close_crafting_process_row::*;
pub use self::create_crafting_process_row::*;
pub use self::deregister_crafting_facility_row::*;
pub use self::deregister_recipe_category_row::*;
pub use self::drain_craftable_item_bank_row::*;
pub use self::initialize_domain_row::*;
pub use self::legitimize_recipe_ingredient_row::*;
pub use self::register_craftable_item_row::*;
pub use self::register_crafting_facility_row::*;
pub use self::register_recipe_category_row::*;
pub use self::register_recipe_row::*;
pub use self::remove_consumable_input_from_recipe_row::*;
pub use self::remove_crafting_facility_recipe_category_row::*;
pub use self::remove_non_consumable_input_from_recipe_row::*;
pub use self::remove_output_from_recipe_row::*;
pub use self::remove_recipe_ingredient_row::*;
pub use self::start_crafting_process_row::*;
pub use self::stop_crafting_process_row::*;
pub use self::update_crafting_facility_row::*;
pub use self::update_domain_row::*;
pub use self::update_recipe_category_row::*;
pub use self::update_recipe_row::*;

use super::CraftingInstruction;

pub struct CraftingInstructionsMigration;

impl sqlx_migrator::Migration<sqlx::Postgres> for CraftingInstructionsMigration {
    fn app(&self) -> &str {
        "crafting"
    }

    fn name(&self) -> &str {
        "crafting_instructions"
    }

    fn operations(&self) -> Vec<Box<dyn sqlx_migrator::Operation<sqlx::Postgres>>> {
        vec![
            Box::new(AddConsumableInputToRecipeMigrationOperation),
            Box::new(AddCraftingFacilityRecipeCategoryMigrationOperation),
            Box::new(AddNonConsumableInputToRecipeMigrationOperation),
            Box::new(AddOutputToRecipeMigrationOperation),
            Box::new(AddRecipeIngredientMigrationOperation),
            Box::new(BurnConsumableIngredientMigrationOperation),
            Box::new(CancelCraftingProcessMigrationOperation),
            Box::new(ClaimNonConsumableIngredientMigrationOperation),
            Box::new(ClaimRecipeOutputMigrationOperation),
            Box::new(CloseCraftingProcessMigrationOperation),
            Box::new(CreateCraftingProcessMigrationOperation),
            Box::new(DeregisterCraftingFacilityMigrationOperation),
            Box::new(DeregisterRecipeCategoryMigrationOperation),
            Box::new(DrainCraftableItemBankMigrationOperation),
            Box::new(InitializeDomainMigrationOperation),
            Box::new(LegitimizeRecipeIngredientMigrationOperation),
            Box::new(RegisterCraftableItemMigrationOperation),
            Box::new(RegisterCraftingFacilityMigrationOperation),
            Box::new(RegisterRecipeMigrationOperation),
            Box::new(RegisterRecipeCategoryMigrationOperation),
            Box::new(RemoveConsumableInputFromRecipeMigrationOperation),
            Box::new(RemoveCraftingFacilityRecipeCategoryMigrationOperation),
            Box::new(RemoveNonConsumableInputFromRecipeMigrationOperation),
            Box::new(RemoveOutputFromRecipeMigrationOperation),
            Box::new(RemoveRecipeIngredientMigrationOperation),
            Box::new(StartCraftingProcessMigrationOperation),
            Box::new(StopCraftingProcessMigrationOperation),
            Box::new(UpdateCraftingFacilityMigrationOperation),
            Box::new(UpdateDomainMigrationOperation),
            Box::new(UpdateRecipeMigrationOperation),
            Box::new(UpdateRecipeCategoryMigrationOperation),
        ]
    }

    fn parents(&self) -> Vec<Box<dyn sqlx_migrator::Migration<sqlx::Postgres>>> {
        vec![]
    }
}

pub struct CraftingInstructionWithMetadata(
    pub CraftingInstruction,
    pub carbon_core::instruction::InstructionMetadata,
);

impl
    From<(
        CraftingInstruction,
        carbon_core::instruction::InstructionMetadata,
    )> for CraftingInstructionWithMetadata
{
    fn from(
        value: (
            CraftingInstruction,
            carbon_core::instruction::InstructionMetadata,
        ),
    ) -> Self {
        CraftingInstructionWithMetadata(value.0, value.1)
    }
}

#[async_trait::async_trait]
impl carbon_core::postgres::operations::Insert for CraftingInstructionWithMetadata {
    async fn insert(&self, pool: &sqlx::PgPool) -> carbon_core::error::CarbonResult<()> {
        let CraftingInstructionWithMetadata(instruction, metadata) = self;
        match instruction {
            CraftingInstruction::AddConsumableInputToRecipe(instruction) => {
                let row =
                    add_consumable_input_to_recipe_row::AddConsumableInputToRecipeRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                    );
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::AddCraftingFacilityRecipeCategory(instruction) => {
                let row = add_crafting_facility_recipe_category_row::AddCraftingFacilityRecipeCategoryRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::AddNonConsumableInputToRecipe(instruction) => {
                let row = add_non_consumable_input_to_recipe_row::AddNonConsumableInputToRecipeRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::AddOutputToRecipe(instruction) => {
                let row = add_output_to_recipe_row::AddOutputToRecipeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::AddRecipeIngredient(instruction) => {
                let row = add_recipe_ingredient_row::AddRecipeIngredientRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::BurnConsumableIngredient(instruction) => {
                let row = burn_consumable_ingredient_row::BurnConsumableIngredientRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::CancelCraftingProcess(instruction) => {
                let row = cancel_crafting_process_row::CancelCraftingProcessRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::ClaimNonConsumableIngredient(instruction) => {
                let row = claim_non_consumable_ingredient_row::ClaimNonConsumableIngredientRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::ClaimRecipeOutput(instruction) => {
                let row = claim_recipe_output_row::ClaimRecipeOutputRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::CloseCraftingProcess(instruction) => {
                let row = close_crafting_process_row::CloseCraftingProcessRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::CreateCraftingProcess(instruction) => {
                let row = create_crafting_process_row::CreateCraftingProcessRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::DeregisterCraftingFacility(instruction) => {
                let row =
                    deregister_crafting_facility_row::DeregisterCraftingFacilityRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                    );
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::DeregisterRecipeCategory(instruction) => {
                let row = deregister_recipe_category_row::DeregisterRecipeCategoryRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::DrainCraftableItemBank(instruction) => {
                let row = drain_craftable_item_bank_row::DrainCraftableItemBankRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::InitializeDomain(instruction) => {
                let row = initialize_domain_row::InitializeDomainRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::LegitimizeRecipeIngredient(instruction) => {
                let row =
                    legitimize_recipe_ingredient_row::LegitimizeRecipeIngredientRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                    );
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::RegisterCraftableItem(instruction) => {
                let row = register_craftable_item_row::RegisterCraftableItemRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::RegisterCraftingFacility(instruction) => {
                let row = register_crafting_facility_row::RegisterCraftingFacilityRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::RegisterRecipe(instruction) => {
                let row = register_recipe_row::RegisterRecipeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::RegisterRecipeCategory(instruction) => {
                let row = register_recipe_category_row::RegisterRecipeCategoryRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::RemoveConsumableInputFromRecipe(instruction) => {
                let row = remove_consumable_input_from_recipe_row::RemoveConsumableInputFromRecipeRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::RemoveCraftingFacilityRecipeCategory(instruction) => {
                let row = remove_crafting_facility_recipe_category_row::RemoveCraftingFacilityRecipeCategoryRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::RemoveNonConsumableInputFromRecipe(instruction) => {
                let row = remove_non_consumable_input_from_recipe_row::RemoveNonConsumableInputFromRecipeRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::RemoveOutputFromRecipe(instruction) => {
                let row = remove_output_from_recipe_row::RemoveOutputFromRecipeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::RemoveRecipeIngredient(instruction) => {
                let row = remove_recipe_ingredient_row::RemoveRecipeIngredientRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::StartCraftingProcess(instruction) => {
                let row = start_crafting_process_row::StartCraftingProcessRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::StopCraftingProcess(instruction) => {
                let row = stop_crafting_process_row::StopCraftingProcessRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::UpdateCraftingFacility(instruction) => {
                let row = update_crafting_facility_row::UpdateCraftingFacilityRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::UpdateDomain(instruction) => {
                let row = update_domain_row::UpdateDomainRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::UpdateRecipe(instruction) => {
                let row = update_recipe_row::UpdateRecipeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            CraftingInstruction::UpdateRecipeCategory(instruction) => {
                let row = update_recipe_category_row::UpdateRecipeCategoryRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
        }
    }
}

#[async_trait::async_trait]
impl carbon_core::postgres::operations::Upsert for CraftingInstructionWithMetadata {
    async fn upsert(&self, pool: &sqlx::PgPool) -> carbon_core::error::CarbonResult<()> {
        let CraftingInstructionWithMetadata(instruction, metadata) = self;
        match instruction {
            CraftingInstruction::AddConsumableInputToRecipe(instruction) => {
                let row =
                    add_consumable_input_to_recipe_row::AddConsumableInputToRecipeRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                    );
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::AddCraftingFacilityRecipeCategory(instruction) => {
                let row = add_crafting_facility_recipe_category_row::AddCraftingFacilityRecipeCategoryRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::AddNonConsumableInputToRecipe(instruction) => {
                let row = add_non_consumable_input_to_recipe_row::AddNonConsumableInputToRecipeRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::AddOutputToRecipe(instruction) => {
                let row = add_output_to_recipe_row::AddOutputToRecipeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::AddRecipeIngredient(instruction) => {
                let row = add_recipe_ingredient_row::AddRecipeIngredientRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::BurnConsumableIngredient(instruction) => {
                let row = burn_consumable_ingredient_row::BurnConsumableIngredientRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::CancelCraftingProcess(instruction) => {
                let row = cancel_crafting_process_row::CancelCraftingProcessRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::ClaimNonConsumableIngredient(instruction) => {
                let row = claim_non_consumable_ingredient_row::ClaimNonConsumableIngredientRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::ClaimRecipeOutput(instruction) => {
                let row = claim_recipe_output_row::ClaimRecipeOutputRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::CloseCraftingProcess(instruction) => {
                let row = close_crafting_process_row::CloseCraftingProcessRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::CreateCraftingProcess(instruction) => {
                let row = create_crafting_process_row::CreateCraftingProcessRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::DeregisterCraftingFacility(instruction) => {
                let row =
                    deregister_crafting_facility_row::DeregisterCraftingFacilityRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                    );
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::DeregisterRecipeCategory(instruction) => {
                let row = deregister_recipe_category_row::DeregisterRecipeCategoryRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::DrainCraftableItemBank(instruction) => {
                let row = drain_craftable_item_bank_row::DrainCraftableItemBankRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::InitializeDomain(instruction) => {
                let row = initialize_domain_row::InitializeDomainRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::LegitimizeRecipeIngredient(instruction) => {
                let row =
                    legitimize_recipe_ingredient_row::LegitimizeRecipeIngredientRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                    );
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::RegisterCraftableItem(instruction) => {
                let row = register_craftable_item_row::RegisterCraftableItemRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::RegisterCraftingFacility(instruction) => {
                let row = register_crafting_facility_row::RegisterCraftingFacilityRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::RegisterRecipe(instruction) => {
                let row = register_recipe_row::RegisterRecipeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::RegisterRecipeCategory(instruction) => {
                let row = register_recipe_category_row::RegisterRecipeCategoryRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::RemoveConsumableInputFromRecipe(instruction) => {
                let row = remove_consumable_input_from_recipe_row::RemoveConsumableInputFromRecipeRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::RemoveCraftingFacilityRecipeCategory(instruction) => {
                let row = remove_crafting_facility_recipe_category_row::RemoveCraftingFacilityRecipeCategoryRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::RemoveNonConsumableInputFromRecipe(instruction) => {
                let row = remove_non_consumable_input_from_recipe_row::RemoveNonConsumableInputFromRecipeRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::RemoveOutputFromRecipe(instruction) => {
                let row = remove_output_from_recipe_row::RemoveOutputFromRecipeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::RemoveRecipeIngredient(instruction) => {
                let row = remove_recipe_ingredient_row::RemoveRecipeIngredientRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::StartCraftingProcess(instruction) => {
                let row = start_crafting_process_row::StartCraftingProcessRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::StopCraftingProcess(instruction) => {
                let row = stop_crafting_process_row::StopCraftingProcessRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::UpdateCraftingFacility(instruction) => {
                let row = update_crafting_facility_row::UpdateCraftingFacilityRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::UpdateDomain(instruction) => {
                let row = update_domain_row::UpdateDomainRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::UpdateRecipe(instruction) => {
                let row = update_recipe_row::UpdateRecipeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            CraftingInstruction::UpdateRecipeCategory(instruction) => {
                let row = update_recipe_category_row::UpdateRecipeCategoryRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
        }
    }
}

//! This code was AUTOGENERATED using the Codama library.
pub mod add_fee_exemption_row;
pub mod add_royalty_tier_row;
pub mod delete_royalty_tier_row;
pub mod deregister_currency_row;
pub mod initialize_marketplace_row;
pub mod initialize_open_orders_counter_row;
pub mod noop_row;
pub mod process_cancel_row;
pub mod process_exchange_row;
pub mod process_initialize_buy_pda_row;
pub mod process_initialize_buy_row;
pub mod process_initialize_sell_pda_row;
pub mod process_initialize_sell_row;
pub mod register_currency_row;
pub mod remove_fee_exemption_row;
pub mod update_atlas_rate_row;
pub mod update_currency_royalty_row;
pub mod update_currency_vault_row;
pub mod update_royalty_tier_row;

pub use self::add_fee_exemption_row::*;
pub use self::add_royalty_tier_row::*;
pub use self::delete_royalty_tier_row::*;
pub use self::deregister_currency_row::*;
pub use self::initialize_marketplace_row::*;
pub use self::initialize_open_orders_counter_row::*;
pub use self::noop_row::*;
pub use self::process_cancel_row::*;
pub use self::process_exchange_row::*;
pub use self::process_initialize_buy_pda_row::*;
pub use self::process_initialize_buy_row::*;
pub use self::process_initialize_sell_pda_row::*;
pub use self::process_initialize_sell_row::*;
pub use self::register_currency_row::*;
pub use self::remove_fee_exemption_row::*;
pub use self::update_atlas_rate_row::*;
pub use self::update_currency_royalty_row::*;
pub use self::update_currency_vault_row::*;
pub use self::update_royalty_tier_row::*;

use super::MarketplaceInstruction;

pub struct MarketplaceInstructionsMigration;

impl sqlx_migrator::Migration<sqlx::Postgres> for MarketplaceInstructionsMigration {
    fn app(&self) -> &str {
        "marketplace"
    }

    fn name(&self) -> &str {
        "marketplace_instructions"
    }

    fn operations(&self) -> Vec<Box<dyn sqlx_migrator::Operation<sqlx::Postgres>>> {
        vec![
            Box::new(AddFeeExemptionMigrationOperation),
            Box::new(AddRoyaltyTierMigrationOperation),
            Box::new(DeleteRoyaltyTierMigrationOperation),
            Box::new(DeregisterCurrencyMigrationOperation),
            Box::new(InitializeMarketplaceMigrationOperation),
            Box::new(InitializeOpenOrdersCounterMigrationOperation),
            Box::new(NoopMigrationOperation),
            Box::new(ProcessCancelMigrationOperation),
            Box::new(ProcessExchangeMigrationOperation),
            Box::new(ProcessInitializeBuyMigrationOperation),
            Box::new(ProcessInitializeBuyPdaMigrationOperation),
            Box::new(ProcessInitializeSellMigrationOperation),
            Box::new(ProcessInitializeSellPdaMigrationOperation),
            Box::new(RegisterCurrencyMigrationOperation),
            Box::new(RemoveFeeExemptionMigrationOperation),
            Box::new(UpdateAtlasRateMigrationOperation),
            Box::new(UpdateCurrencyRoyaltyMigrationOperation),
            Box::new(UpdateCurrencyVaultMigrationOperation),
            Box::new(UpdateRoyaltyTierMigrationOperation),
        ]
    }

    fn parents(&self) -> Vec<Box<dyn sqlx_migrator::Migration<sqlx::Postgres>>> {
        vec![]
    }
}

pub struct MarketplaceInstructionWithMetadata(
    pub MarketplaceInstruction,
    pub carbon_core::instruction::InstructionMetadata,
);

impl
    From<(
        MarketplaceInstruction,
        carbon_core::instruction::InstructionMetadata,
    )> for MarketplaceInstructionWithMetadata
{
    fn from(
        value: (
            MarketplaceInstruction,
            carbon_core::instruction::InstructionMetadata,
        ),
    ) -> Self {
        MarketplaceInstructionWithMetadata(value.0, value.1)
    }
}

#[async_trait::async_trait]
impl carbon_core::postgres::operations::Insert for MarketplaceInstructionWithMetadata {
    async fn insert(&self, pool: &sqlx::PgPool) -> carbon_core::error::CarbonResult<()> {
        let MarketplaceInstructionWithMetadata(instruction, metadata) = self;
        match instruction {
            MarketplaceInstruction::AddFeeExemption(instruction) => {
                let row = add_fee_exemption_row::AddFeeExemptionRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::AddRoyaltyTier(instruction) => {
                let row = add_royalty_tier_row::AddRoyaltyTierRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::DeleteRoyaltyTier(instruction) => {
                let row = delete_royalty_tier_row::DeleteRoyaltyTierRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::DeregisterCurrency(instruction) => {
                let row = deregister_currency_row::DeregisterCurrencyRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::InitializeMarketplace(instruction) => {
                let row = initialize_marketplace_row::InitializeMarketplaceRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::InitializeOpenOrdersCounter(instruction) => {
                let row =
                    initialize_open_orders_counter_row::InitializeOpenOrdersCounterRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                    );
                row.insert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::Noop(instruction) => {
                let row = noop_row::NoopRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::ProcessCancel(instruction) => {
                let row = process_cancel_row::ProcessCancelRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::ProcessExchange(instruction) => {
                let row = process_exchange_row::ProcessExchangeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::ProcessInitializeBuy(instruction) => {
                let row = process_initialize_buy_row::ProcessInitializeBuyRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::ProcessInitializeBuyPda(instruction) => {
                let row = process_initialize_buy_pda_row::ProcessInitializeBuyPdaRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::ProcessInitializeSell(instruction) => {
                let row = process_initialize_sell_row::ProcessInitializeSellRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::ProcessInitializeSellPda(instruction) => {
                let row = process_initialize_sell_pda_row::ProcessInitializeSellPdaRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::RegisterCurrency(instruction) => {
                let row = register_currency_row::RegisterCurrencyRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::RemoveFeeExemption(instruction) => {
                let row = remove_fee_exemption_row::RemoveFeeExemptionRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::UpdateAtlasRate(instruction) => {
                let row = update_atlas_rate_row::UpdateAtlasRateRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::UpdateCurrencyRoyalty(instruction) => {
                let row = update_currency_royalty_row::UpdateCurrencyRoyaltyRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::UpdateCurrencyVault(instruction) => {
                let row = update_currency_vault_row::UpdateCurrencyVaultRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::UpdateRoyaltyTier(instruction) => {
                let row = update_royalty_tier_row::UpdateRoyaltyTierRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
        }
    }
}

#[async_trait::async_trait]
impl carbon_core::postgres::operations::Upsert for MarketplaceInstructionWithMetadata {
    async fn upsert(&self, pool: &sqlx::PgPool) -> carbon_core::error::CarbonResult<()> {
        let MarketplaceInstructionWithMetadata(instruction, metadata) = self;
        match instruction {
            MarketplaceInstruction::AddFeeExemption(instruction) => {
                let row = add_fee_exemption_row::AddFeeExemptionRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::AddRoyaltyTier(instruction) => {
                let row = add_royalty_tier_row::AddRoyaltyTierRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::DeleteRoyaltyTier(instruction) => {
                let row = delete_royalty_tier_row::DeleteRoyaltyTierRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::DeregisterCurrency(instruction) => {
                let row = deregister_currency_row::DeregisterCurrencyRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::InitializeMarketplace(instruction) => {
                let row = initialize_marketplace_row::InitializeMarketplaceRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::InitializeOpenOrdersCounter(instruction) => {
                let row =
                    initialize_open_orders_counter_row::InitializeOpenOrdersCounterRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                    );
                row.upsert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::Noop(instruction) => {
                let row = noop_row::NoopRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::ProcessCancel(instruction) => {
                let row = process_cancel_row::ProcessCancelRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::ProcessExchange(instruction) => {
                let row = process_exchange_row::ProcessExchangeRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::ProcessInitializeBuy(instruction) => {
                let row = process_initialize_buy_row::ProcessInitializeBuyRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::ProcessInitializeBuyPda(instruction) => {
                let row = process_initialize_buy_pda_row::ProcessInitializeBuyPdaRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::ProcessInitializeSell(instruction) => {
                let row = process_initialize_sell_row::ProcessInitializeSellRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::ProcessInitializeSellPda(instruction) => {
                let row = process_initialize_sell_pda_row::ProcessInitializeSellPdaRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::RegisterCurrency(instruction) => {
                let row = register_currency_row::RegisterCurrencyRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::RemoveFeeExemption(instruction) => {
                let row = remove_fee_exemption_row::RemoveFeeExemptionRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::UpdateAtlasRate(instruction) => {
                let row = update_atlas_rate_row::UpdateAtlasRateRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::UpdateCurrencyRoyalty(instruction) => {
                let row = update_currency_royalty_row::UpdateCurrencyRoyaltyRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::UpdateCurrencyVault(instruction) => {
                let row = update_currency_vault_row::UpdateCurrencyVaultRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            MarketplaceInstruction::UpdateRoyaltyTier(instruction) => {
                let row = update_royalty_tier_row::UpdateRoyaltyTierRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
        }
    }
}

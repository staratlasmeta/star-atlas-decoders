//! This code was AUTOGENERATED using the Codama library.
pub mod accept_role_invitation_row;
pub mod add_existing_member_to_role_row;
pub mod add_keys_row;
pub mod adjust_auth_row;
pub mod create_profile_row;
pub mod create_role_row;
pub mod invite_member_to_role_row;
pub mod join_role_row;
pub mod leave_role_row;
pub mod remove_keys_row;
pub mod remove_member_from_role_row;
pub mod remove_role_row;
pub mod set_name_row;
pub mod set_role_accepting_members_row;
pub mod set_role_authorizer_row;
pub mod set_role_name_row;
pub mod set_role_not_accepting_members_row;

pub use self::accept_role_invitation_row::*;
pub use self::add_existing_member_to_role_row::*;
pub use self::add_keys_row::*;
pub use self::adjust_auth_row::*;
pub use self::create_profile_row::*;
pub use self::create_role_row::*;
pub use self::invite_member_to_role_row::*;
pub use self::join_role_row::*;
pub use self::leave_role_row::*;
pub use self::remove_keys_row::*;
pub use self::remove_member_from_role_row::*;
pub use self::remove_role_row::*;
pub use self::set_name_row::*;
pub use self::set_role_accepting_members_row::*;
pub use self::set_role_authorizer_row::*;
pub use self::set_role_name_row::*;
pub use self::set_role_not_accepting_members_row::*;

use super::PlayerProfileInstruction;

pub struct PlayerProfileInstructionsMigration;

impl sqlx_migrator::Migration<sqlx::Postgres> for PlayerProfileInstructionsMigration {
    fn app(&self) -> &str {
        "player-profile"
    }

    fn name(&self) -> &str {
        "player_profile_instructions"
    }

    fn operations(&self) -> Vec<Box<dyn sqlx_migrator::Operation<sqlx::Postgres>>> {
        vec![
            Box::new(AcceptRoleInvitationMigrationOperation),
            Box::new(AddExistingMemberToRoleMigrationOperation),
            Box::new(AddKeysMigrationOperation),
            Box::new(AdjustAuthMigrationOperation),
            Box::new(CreateProfileMigrationOperation),
            Box::new(CreateRoleMigrationOperation),
            Box::new(InviteMemberToRoleMigrationOperation),
            Box::new(JoinRoleMigrationOperation),
            Box::new(LeaveRoleMigrationOperation),
            Box::new(RemoveKeysMigrationOperation),
            Box::new(RemoveMemberFromRoleMigrationOperation),
            Box::new(RemoveRoleMigrationOperation),
            Box::new(SetNameMigrationOperation),
            Box::new(SetRoleAcceptingMembersMigrationOperation),
            Box::new(SetRoleAuthorizerMigrationOperation),
            Box::new(SetRoleNameMigrationOperation),
            Box::new(SetRoleNotAcceptingMembersMigrationOperation),
        ]
    }

    fn parents(&self) -> Vec<Box<dyn sqlx_migrator::Migration<sqlx::Postgres>>> {
        vec![]
    }
}

pub struct PlayerProfileInstructionWithMetadata(
    pub PlayerProfileInstruction,
    pub carbon_core::instruction::InstructionMetadata,
);

impl
    From<(
        PlayerProfileInstruction,
        carbon_core::instruction::InstructionMetadata,
    )> for PlayerProfileInstructionWithMetadata
{
    fn from(
        value: (
            PlayerProfileInstruction,
            carbon_core::instruction::InstructionMetadata,
        ),
    ) -> Self {
        PlayerProfileInstructionWithMetadata(value.0, value.1)
    }
}

#[async_trait::async_trait]
impl carbon_core::postgres::operations::Insert for PlayerProfileInstructionWithMetadata {
    async fn insert(&self, pool: &sqlx::PgPool) -> carbon_core::error::CarbonResult<()> {
        let PlayerProfileInstructionWithMetadata(instruction, metadata) = self;
        match instruction {
            PlayerProfileInstruction::AcceptRoleInvitation(instruction) => {
                let row = accept_role_invitation_row::AcceptRoleInvitationRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::AddExistingMemberToRole(instruction) => {
                let row = add_existing_member_to_role_row::AddExistingMemberToRoleRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::AddKeys(instruction) => {
                let row =
                    add_keys_row::AddKeysRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::AdjustAuth(instruction) => {
                let row = adjust_auth_row::AdjustAuthRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::CreateProfile(instruction) => {
                let row = create_profile_row::CreateProfileRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::CreateRole(instruction) => {
                let row = create_role_row::CreateRoleRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::InviteMemberToRole(instruction) => {
                let row = invite_member_to_role_row::InviteMemberToRoleRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::JoinRole(instruction) => {
                let row =
                    join_role_row::JoinRoleRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::LeaveRole(instruction) => {
                let row =
                    leave_role_row::LeaveRoleRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::RemoveKeys(instruction) => {
                let row = remove_keys_row::RemoveKeysRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::RemoveMemberFromRole(instruction) => {
                let row = remove_member_from_role_row::RemoveMemberFromRoleRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::RemoveRole(instruction) => {
                let row = remove_role_row::RemoveRoleRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::SetName(instruction) => {
                let row =
                    set_name_row::SetNameRow::from_parts(instruction.clone(), metadata.clone());
                row.insert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::SetRoleAcceptingMembers(instruction) => {
                let row = set_role_accepting_members_row::SetRoleAcceptingMembersRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::SetRoleAuthorizer(instruction) => {
                let row = set_role_authorizer_row::SetRoleAuthorizerRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::SetRoleName(instruction) => {
                let row = set_role_name_row::SetRoleNameRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.insert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::SetRoleNotAcceptingMembers(instruction) => {
                let row =
                    set_role_not_accepting_members_row::SetRoleNotAcceptingMembersRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                    );
                row.insert(pool).await?;
                Ok(())
            }
        }
    }
}

#[async_trait::async_trait]
impl carbon_core::postgres::operations::Upsert for PlayerProfileInstructionWithMetadata {
    async fn upsert(&self, pool: &sqlx::PgPool) -> carbon_core::error::CarbonResult<()> {
        let PlayerProfileInstructionWithMetadata(instruction, metadata) = self;
        match instruction {
            PlayerProfileInstruction::AcceptRoleInvitation(instruction) => {
                let row = accept_role_invitation_row::AcceptRoleInvitationRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::AddExistingMemberToRole(instruction) => {
                let row = add_existing_member_to_role_row::AddExistingMemberToRoleRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::AddKeys(instruction) => {
                let row =
                    add_keys_row::AddKeysRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::AdjustAuth(instruction) => {
                let row = adjust_auth_row::AdjustAuthRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::CreateProfile(instruction) => {
                let row = create_profile_row::CreateProfileRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::CreateRole(instruction) => {
                let row = create_role_row::CreateRoleRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::InviteMemberToRole(instruction) => {
                let row = invite_member_to_role_row::InviteMemberToRoleRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::JoinRole(instruction) => {
                let row =
                    join_role_row::JoinRoleRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::LeaveRole(instruction) => {
                let row =
                    leave_role_row::LeaveRoleRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::RemoveKeys(instruction) => {
                let row = remove_keys_row::RemoveKeysRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::RemoveMemberFromRole(instruction) => {
                let row = remove_member_from_role_row::RemoveMemberFromRoleRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::RemoveRole(instruction) => {
                let row = remove_role_row::RemoveRoleRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::SetName(instruction) => {
                let row =
                    set_name_row::SetNameRow::from_parts(instruction.clone(), metadata.clone());
                row.upsert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::SetRoleAcceptingMembers(instruction) => {
                let row = set_role_accepting_members_row::SetRoleAcceptingMembersRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::SetRoleAuthorizer(instruction) => {
                let row = set_role_authorizer_row::SetRoleAuthorizerRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::SetRoleName(instruction) => {
                let row = set_role_name_row::SetRoleNameRow::from_parts(
                    instruction.clone(),
                    metadata.clone(),
                );
                row.upsert(pool).await?;
                Ok(())
            }
            PlayerProfileInstruction::SetRoleNotAcceptingMembers(instruction) => {
                let row =
                    set_role_not_accepting_members_row::SetRoleNotAcceptingMembersRow::from_parts(
                        instruction.clone(),
                        metadata.clone(),
                    );
                row.upsert(pool).await?;
                Ok(())
            }
        }
    }
}

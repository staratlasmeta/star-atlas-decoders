//! This code was AUTOGENERATED using the Codama library.
use carbon_core::borsh;
use solana_pubkey::Pubkey;

use super::ProfilePermissions;

/// Struct for adding a key

#[cfg_attr(feature = "serde", derive(serde::Serialize, serde::Deserialize))]
#[derive(Debug, Clone, borsh::BorshSerialize, borsh::BorshDeserialize, PartialEq, Eq, Hash)]
pub struct AddKeyInput {
    /// The block of permissions
    pub scope: Pubkey,
    /// The expire time of the key to add
    pub expire_time: i64,
    /// The permissions for the key
    pub permissions: [u8; 8],
}

impl AddKeyInput {
    /// Convert the raw permission bytes to a u64 value.
    pub fn permissions_as_u64(&self) -> u64 {
        u64::from_le_bytes(self.permissions)
    }

    /// Get the permissions as a ProfilePermissions bitflags type.
    pub fn permissions_flags(&self) -> ProfilePermissions {
        ProfilePermissions::from_le_bytes(self.permissions)
    }

    /// Check if this input has a specific permission flag set.
    pub fn has_permission(&self, flag: ProfilePermissions) -> bool {
        self.permissions_flags().contains(flag)
    }

    /// Check if this input grants auth permission.
    pub fn is_auth(&self) -> bool {
        self.has_permission(ProfilePermissions::AUTH)
    }
}
